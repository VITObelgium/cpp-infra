SET(MAJOR 1)
SET(MINOR 10)
SET(REVISION 0-patch1)
SET(NAME hdf5)
SET(PACKAGE ${NAME}-${MAJOR}.${MINOR}.${REVISION})

IF (UNIX AND NOT APPLE)
    SET(EXTRA_FLAGS -DCMAKE_C_FLAGS=-DH5_HAVE_SYS_FILE_H=1 -DCMAKE_CXX_FLAGS=-DH5_HAVE_SYS_FILE_H=1)
ENDIF ()

EXTERNALPROJECT_ADD(${NAME}
    DEPENDS zlib
    URL https://support.hdfgroup.org/ftp/HDF5/releases/${NAME}-${MAJOR}.${MINOR}/${PACKAGE}/src/${PACKAGE}.tar.bz2 TIMEOUT 360
    INSTALL_DIR ${CMAKE_INSTALL_PREFIX}
    CMAKE_ARGS -G ${CMAKE_GENERATOR}
               -DBUILD_SHARED_LIBS=OFF
               -DCMAKE_BUILD_TYPE=${CMAKE_BUILD_TYPE}
               -DCMAKE_TOOLCHAIN_FILE=${CMAKE_TOOLCHAIN_FILE}
               -DCMAKE_PREFIX_PATH=${CMAKE_CURRENT_BINARY_DIR}/../local
               -DBUILD_TESTING=OFF
               -DHDF5_BUILD_TOOLS=OFF
               -DHDF5_BUILD_EXAMPLES=OFF
               -DHDF5_BUILD_HL_LIB=OFF
               -DCMAKE_INSTALL_PREFIX=<INSTALL_DIR>
               ${EXTRA_FLAGS}
)