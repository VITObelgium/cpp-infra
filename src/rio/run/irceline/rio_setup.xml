<?xml version="1.0" encoding="UTF-8" ?>
<rio>
  <!-- Important note:
       Wildcards to be used in this XML file
       
       %pol%  : the pollutant name
       %aggr% : the aggregation time : da, 1h, ...
       %ipol% : the mapper name
       %grid% : the name of the grid
       %cnf%  : the configuration name
       %base% : the working directory

       %timestamp%  : the current timestamp for the interpolation
       %date%       : the current day for the interpolation
       %start_time% : timestamp for the start of the run
       %end_time%   : timestamp for the end of the run
  -->
  <!-- the default values for this deployment, no wildcards allowed here -->
  <defaults>
    <base_path>.</base_path>
    <configuration>v2018</configuration>
    <pollutant>pm10</pollutant>
    <aggregation>1h</aggregation>
    <mapper>clc06d</mapper>
    <grid>4x4</grid>
    <output>txt</output>
    <!-- can be comma separated list -->
  </defaults>

  <!-- here we define the available outputs -->
  <output>
    <!-- simple ascii text writer -->
    <handler name="txt" class="asciiwriter">
      <location>%base%/output/%pol%_%ipol%_%grid%-%timestamp%.txt</location>
      <field_separator>;</field_separator>
      <precision>2</precision>        
    </handler>

    <!-- ircel output writer -->
    <handler name="ircel" class="ircelwriter">
      <location>%base%/output/%pol%_%ipol%_%grid%-%date%.txt</location>
    </handler>

    <!-- hdf5 writer -->
    <handler name="hdf5" class="h5writer">
      <location>%base%/output/%pol%_%ipol%_%grid%-%start_time%-%end_time%.h5</location>
    </handler>

    <!-- GeoJSON writer -->
    <handler name="json" class="jsonwriter">
      <location>%base%/output/%pol%_%ipol%_%grid%_%timestamp%.json</location>
    </handler>
	
	<!-- IFDM writer -->
	<!-- Writes out a flat unformatted stream binary for FORTRAN import -->
    <handler name="ifdm" class="ifdmwriter">
		<location>%base%/output/%pol%_%ipol%_%grid%_%timestamp%.bin</location>		
		
		<griddef grid="4x4" epsg="31360" missing="-9999"
		         nx="69" ny="57" dx="4000." dy="4000." xull="22000." yull="248000.">
			%base%/grids/rio_4x4_grid.map
		</griddef>
		
		<griddef grid="4x4e1" epsg="31360" missing="-9999"
		         nx="71" ny="59" dx="4000." dy="4000." xull="18000." yull="252000.">
			%base%/grids/rio_4x4e1_grid.map
		</griddef>
		
		<griddef grid="4x4e2" epsg="31360" missing="-9999"
		         nx="73" ny="61" dx="4000." dy="4000." xull="14000." yull="256000.">
			%base%/grids/rio_4x4e2_grid.map
		</griddef>
		
	 </handler>
  </output>

  <!-- here are the different configurations in this deployment -->
  <configuration name="v2018">
    <author>Bino Maiheu</author>
    <email>bino.maiheu@vito.be</email>
    <description>This is the configuration for a testrun</description>
    <missing_value>-9999.</missing_value>

    <observations>
      <dbqfile type="RIO" scale="1.0">%base%/data/%pol%_data_rio.txt</dbqfile>
    </observations>

    <!-- Note: the stations and grids tags here are generic, they can be
	       overwritten inside the <mapper> model tags with specific versions -->
    <stations>
      <filename>%base%/stations/%cnf%/%pol%_stations_%ipol%.txt</filename>
    </stations>
    
    <grids>
      <grid name="4x4" cellsize="4000.">%base%/grids/%pol%_grid_4x4_%ipol%.txt</grid>
      <grid name="1x1" cellsize="1000.">%base%/grids/%pol%_grid_1x1_%ipol%.txt</grid>
    </grids>
        
    <!-- the pollutant configuration occurs in the pollutant tags below here... -->
    <pollutant name="pm10,pm25" aggr="da,1h">
      <detection_limit>1.0</detection_limit>

      <mapper name="clc06d" class="rio_ipol">
        <!-- general options -->
        <options>
          <logtrans>enable</logtrans>
        </options>
        <correlationmodel class="exp_spcorr">%base%/param/%cnf%/%pol%_spcorr_%ipol%.xml</correlationmodel>
        <trendmodel class="polytrend">%base%/param/%cnf%/%pol%_trend_%ipol%_%aggr%.xml</trendmodel>
      </mapper>
      
      <mapper name="ordkrig" class="krige_ipol">
        <!-- general options -->
        <options>
          <logtrans>enable</logtrans>
        </options>
        <!-- overwriting generic stations and grids with specific one, compatible with this, re-using the clc06d -->
        <stations>
          <filename>%base%/stations/%cnf%/%pol%_stations_clc06d.txt</filename>
        </stations>
        <grids>
          <grid name="4x4" cellsize="4000.">%base%/grids/%pol%_grid_4x4_clc06d.txt</grid>
        </grids>
        <!-- using the same correlation model for the kriging as for the rio (detrended) -->
        <correlationmodel class="exp_spcorr">%base%/param/%cnf%/%pol%_spcorr_clc06d.xml</correlationmodel>
      </mapper>

      <mapper name="idw" class="idw_ipol">
        <!-- general options -->
        <options>
          <power>1.5</power>
        </options>
        <!-- overwriting generic stations with specific one, re-using the clc06d -->
        <stations>
          <filename>%base%/stations/%cnf%/%pol%_stations_clc06d.txt</filename>
        </stations>
        <grids>
          <grid name="4x4" cellsize="4000.">%base%/grids/%pol%_grid_4x4_clc06d.txt</grid>
        </grids>
      </mapper>
    </pollutant>

    <pollutant name="no2" aggr="da,1h">
      <detection_limit>1.0</detection_limit>
      <mapper name="idw" class="idw_ipol">
        <options>
          <power>1.0</power>
        </options>
        <!-- overwriting generic stations with specific one, re-using the clc06d -->
        <stations>
          <filename>%base%/stations/%cnf%/%pol%_stations_clc06d.txt</filename>
        </stations>
        <grids>
          <grid name="4x4" cellsize="4000.">%base%/grids/%pol%_grid_4x4_clc06d.txt</grid>
        </grids>
      </mapper>

    </pollutant>

  </configuration>

  <!-- here are the different configurations in this deployment -->
  <configuration name="v2016">
    <author>Bino Maiheu</author>
    <email>bino.maiheu@vito.be</email>
    <description>This is the configuration v2016</description>
    <missing_value>-9999.</missing_value>

    <observations>
      <dbqfile type="RIO" scale="1.0">%base%/data/%pol%_data_rio.txt</dbqfile>
    </observations>

    <!-- Note: the stations and grids tags here are generic, they can be
	       overwritten inside the <mapper> model tags with specific versions -->
    <stations>
      <filename>%base%/stations/%cnf%/%pol%_stations_info_GIS_%ipol%.txt</filename>
    </stations>
    
    <grids>
      <grid name="awac" cellsize="4000.">%base%/grids/%cnf%/%pol%_grid_awac_%ipol%.txt</grid>
	  <grid name="4x4"  cellsize="4000.">%base%/grids/%cnf%/%pol%_grid_4x4_%ipol%.txt</grid>
      <grid name="1x1"  cellsize="1000.">%base%/grids/%cnf%/%pol%_grid_1x1_%ipol%.txt</grid>      
    </grids>
    
    
    <!-- the pollutant configuration occurs in the pollutant tags below here... -->
    <pollutant name="pm10,pm25" aggr="da,1h">
      <detection_limit>1.0</detection_limit>

      <mapper name="clc06d" class="rio_ipol">
        <!-- general options -->
        <options>
          <logtrans>enable</logtrans>
        </options>
        <correlationmodel class="exp_spcorr">%base%/param/%cnf%/spcorr_%pol%_%aggr%_%ipol%.xml</correlationmodel>
        <trendmodel class="polytrend">%base%/param/%cnf%/trend_%pol%_%aggr%_%ipol%.xml</trendmodel>
      </mapper>
      
      <mapper name="ordkrig" class="krige_ipol">
        <!-- general options -->
        <options>
          <logtrans>enable</logtrans>
        </options>
        <!-- overwriting generic stations and grids with specific one, compatible with this, re-using the clc06d -->
        <stations>
          <filename>%base%/stations/%cnf%/%pol%_stations_clc06d.txt</filename>
        </stations>
        <grids>
          <grid name="4x4" cellsize="4000.">%base%/grids/%cnf%/%pol%_grid_4x4_clc06d.txt</grid>
        </grids>
        <!-- using the same correlation model for the kriging as for the rio (detrended) -->
        <correlationmodel class="exp_spcorr">%base%/param/%cnf%/spcorr_%pol%_%aggr%_clc06d.xml</correlationmodel>
      </mapper>
    
    </pollutant>

  </configuration>

  <configuration name="v3.6">
    <author>Bino Maiheu</author>
    <email>bino.maiheu@vito.be</email>
    <description>This is the configuration v3.6</description>
    <missing_value>-9999.</missing_value>

    <observations>
      <!-- <dbqfile type="RIO" scale="1.0">%base%/data/%pol%_data_rio_2015.txt</dbqfile> -->
      <dbqfile type="RIO" scale="1.0">%base%/data/%pol%_data_rio.txt</dbqfile>
    </observations>

    <!-- Note: the stations and grids tags here are generic, they can be
	       overwritten inside the <mapper> model tags with specific versions -->
    <stations>
      <filename>%base%/stations/%cnf%/%pol%_stations_info_GIS_%ipol%.txt</filename>
    </stations>
    
    <grids>
	  <grid name="awac" cellsize="4000.">%base%/grids/%cnf%/%pol%_grid_awac_%ipol%.txt</grid>
      <grid name="4x4" cellsize="4000.">%base%/grids/%cnf%/%pol%_grid_4x4_%ipol%.txt</grid>
      <grid name="1x1" cellsize="1000.">%base%/grids/%cnf%/%pol%_grid_1x1_%ipol%.txt</grid>      
    </grids>
    
    <!-- the pollutant configuration occurs in the pollutant tags below here... -->
    <pollutant name="pm10,pm25,no2,o3,so2" aggr="da,1h">
      <detection_limit>1.0</detection_limit>

      <mapper name="clc06d" class="rio_ipol">
        <!-- general options -->
        <options>
          <logtrans>enable</logtrans>
        </options>
        <correlationmodel class="exp_spcorr">%base%/param/%cnf%/spcorr_%pol%_%aggr%_%ipol%.xml</correlationmodel>
        <trendmodel class="polytrend">%base%/param/%cnf%/trend_%pol%_%aggr%_%ipol%.xml</trendmodel>
      </mapper>
      
      <mapper name="ordkrig" class="krige_ipol">
        <!-- general options -->
        <options>
          <logtrans>enable</logtrans>
        </options>
        <!-- overwriting generic stations and grids with specific one, compatible with this, re-using the clc06d -->
        <stations>
          <filename>%base%/stations/%cnf%/%pol%_stations_clc06d.txt</filename>
        </stations>
        <grids>
          <grid name="4x4" cellsize="4000.">%base%/grids/%cnf%/%pol%_grid_4x4_clc06d.txt</grid>
        </grids>
        <!-- using the same correlation model for the kriging as for the rio (detrended) -->
        <correlationmodel class="exp_spcorr">%base%/param/%cnf%/spcorr_%pol%_%aggr%_clc06d.xml</correlationmodel>
      </mapper>

    </pollutant>

    <!-- the pollutant configuration occurs in the pollutant tags below here... -->
    <pollutant name="bc" aggr="da,1h">
      <detection_limit>0.01</detection_limit>

      <mapper name="clc06d" class="rio_ipol">
        <!-- general options -->
        <options>
          <logtrans>enable</logtrans>
        </options>
        <correlationmodel class="exp_spcorr">%base%/param/%cnf%/spcorr_%pol%_%aggr%_%ipol%.xml</correlationmodel>
        <trendmodel class="polytrend">%base%/param/%cnf%/trend_%pol%_%aggr%_%ipol%.xml</trendmodel>
      </mapper>
      
      <mapper name="ordkrig" class="krige_ipol">
        <!-- general options -->
        <options>
          <logtrans>enable</logtrans>
        </options>
        <!-- overwriting generic stations and grids with specific one, compatible with this, re-using the clc06d -->
        <stations>
          <filename>%base%/stations/%cnf%/%pol%_stations_clc06d.txt</filename>
        </stations>
        <grids>
          <grid name="4x4" cellsize="4000.">%base%/grids/%cnf%/%pol%_grid_4x4_clc06d.txt</grid>
        </grids>
        <!-- using the same correlation model for the kriging as for the rio (detrended) -->
        <correlationmodel class="exp_spcorr">%base%/param/%cnf%/spcorr_%pol%_%aggr%_clc06d.xml</correlationmodel>
      </mapper>

    </pollutant>

  </configuration>

</rio>